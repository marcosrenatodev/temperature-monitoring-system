<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{title}</title>
    <link rel="stylesheet" href="/static/css/dashboard.css" />
</head>
<body>
    <div class="container">
        <header>
            <h1>{title}</h1>
            <div class="timestamp">Last updated: {timestamp}</div>
            <div class="toolbar">
                <a href="?filter=all" data-tb-nav data-filter="all">All</a>
                <a href="?filter=active" data-tb-nav data-filter="active">Active</a>
                <a href="?filter=inactive" data-tb-nav data-filter="inactive">Inactive</a>
                <input id="sensor-search" type="search" placeholder="Search sensor (name/id/location)..." />
            </div>
        </header>

        <div class="stats">
            <div class="stat-card">
                <h3>Total Sensors</h3>
                <div class="value" id="stat-total-sensors">{sensors.length}</div>
            </div>
            <div class="stat-card">
                <h3>Recent Alerts</h3>
                <div class="value" id="stat-recent-alerts">{alerts.length}</div>
            </div>
        </div>

        <div class="sensors-grid">
            {#sensors}
            <div class="sensor-card"
                 data-sensor-id="{sensor_id}"
                 data-active="{?active}1{:else}0{/active}"
                 data-name="{name}"
                 data-location="{location}">
                <div class="sensor-header">
                    <a class="sensor-name" href="?sensor={sensor_id}" data-tb-nav>{name}</a>
                    <span class="sensor-status {?active}status-active{:else}status-inactive{/active}">
                        {?active}Active{:else}Inactive{/active}
                    </span>
                </div>

                <div class="sensor-id">ID: {sensor_id}</div>
                {?location}
                <div class="sensor-location">ğŸ“ {location}</div>
                {/location}

                {?latest_reading}
                <div class="readings">
                    <div class="reading">
                        <div class="reading-label">Temperature</div>
                        <div class="reading-value temp-value">
                            {latest_reading.temperature}<span class="reading-unit">Â°C</span>
                        </div>
                    </div>
                    <div class="reading">
                        <div class="reading-label">Humidity</div>
                        <div class="reading-value humidity-value">
                            {latest_reading.humidity}<span class="reading-unit">%</span>
                        </div>
                    </div>
                </div>
                {:else}
                <div class="no-data">No readings available</div>
                {/latest_reading}

                <div class="thresholds">
                    <strong>Limits:</strong><br>
                    ğŸŒ¡ï¸ {min_temperature}Â°C - {max_temperature}Â°C<br>
                    ğŸ’§ {min_humidity}% - {max_humidity}%
                </div>
            </div>
            {:else}
            <div class="no-data">No sensors registered</div>
            {/sensors}
        </div>

        <div class="alerts-section">
            <h2>Recent Alerts (Last Hour)</h2>
            {#alerts}
            <div class="alert-item">
                <div class="alert-header">
                    <span class="alert-sensor">Sensor: {sensor_id}</span>
                    <span class="alert-time">{created_at}</span>
                </div>
                <div class="alert-message">{message}</div>
            </div>
            {:else}
            <div class="no-data">No recent alerts</div>
            {/alerts}
        </div>
    </div>
    <div id="drawer-backdrop" class="drawer-backdrop"></div>
    <aside id="sensor-drawer" class="drawer" aria-hidden="true"></aside>


    <script data-main="/static/js/dashboard-main" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>

</body>
</html>
